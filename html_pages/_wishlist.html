<!DOCTYPE html>
<html>
<head>
  <link rel = "stylesheet" href = "TopNav.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

  <div class="topnav">
    <h1 style="color:green; text-align:center;
    font-family:verdana; font-size: 50px;">GEEK TEXT</h1>
    <p style="color:green; text-align:center; font-family:courier; ">
      Thinkgeek + Barnes and Nobel's love child.</p>
    <a href="_homepage.html">Home</a>
    <a href="_books.html">Books</a>
    <a class="active" href="_wishlist.html">Wishlist</a>
    <a href="_shoppingcart.html">Shopping Cart</a>
    <a href="_profile.html">Profile</a>
  </div>

<div style="padding-left:16px">
  <h2>Wishlist</h2>
<form method="get" action="/wishlist">
  Search product directory:
  <input type="text" name="search">
  <input type="submit" value="Search">
</form>


<script>
var database = ["Flat Stanley by John Cena", "The Never Ending Story by Elvis Presley", "Hairy by Me", "Buy, By, or Bye? by Kendrick Lallama"];

function get(name){
  //Read get requests
  //name (String): identifier for get request
   if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
      return decodeURIComponent(name[1]);
}

function query(search_for){
  //find all matches of the user's input within the database
  // search_for (String): what to query for

  if (search_for != undefined){
    var searchUpper = search_for.toUpperCase();
  }

  var matches = []; //stores all matches from query
  for (i = 0; i <= database.length - 1; i++){

    //Changing everything to uppercase in order to ignore case
    var databaseUpper = database[i].toUpperCase();

    if(matches.length >= 0 && databaseUpper.includes(searchUpper)){
      matches.push(database[i]);
    }
  }

  // If there are no matches and search_for is defined/present
  if (matches.length == 0 && search_for != undefined){
    alert("There are no results for that query.");
  }
  return matches.reverse();
}

function addRow(column1, column2, column3, column4){
  //Add a row to "resultstable"
  //column1 (String)
  //column2 (String)
  //column3 (String)
  //column4 (String)
  var table = document.getElementById("resultstable");
  var row = table.insertRow(1);
  var cell1 = row.insertCell(0);
  var cell2 = row.insertCell(1);
  var cell3 = row.insertCell(2);
  var cell4 = row.insertCell(3);
  cell1.innerHTML = column1;
  cell2.innerHTML = column2;
  cell3.innerHTML = column3;
  cell4.innerHTML = column4;
}

</script>

<style>
table, td{
  border: 1px solid black;
  text-align: center;
}

</style>

<table id="resultstable">
  <tr>
    <td>Title</td>
    <td>Wishlist 1</td>
    <td>Wishlist 2</td>
    <td>Wishlist 3</td>
  </tr>
</table>

<button onclick="addToWishlist()">Add Book(s) To Wishlist(s)</button> <br>


<script>
var matches = query(get("search"));


for(i = matches.length - 1; i >= 0; i--){
  var title = matches[i];
  var checkboxHTML1 = '<input type="checkbox" id=' + '"' + matches[i] + 'wishlist1">';
  var checkboxHTML2 = '<input type="checkbox" id=' + '"' + matches[i] + 'wishlist2">';
  var checkboxHTML3 = '<input type="checkbox" id=' + '"' + matches[i] + 'wishlist3">';
  addRow(title, checkboxHTML1, checkboxHTML2, checkboxHTML3)
}

</script>


<style>
#wishlistWrapper {
  width: 100%;
  text-align: center;
}
#wishlist1 {
  width: 150px;
  float: left;
  position: relative;
}
#wishlist2 {
  width: 150px;
  margin: 0 auto;
  position: relative;
}
#wishlist3 {
  width: 150px;
  float: right;
  position: relative;
}


</style>

Insert name of wishlist to add/remove:
<input type="text" id="wishlistname">
<button onclick="addWishlist()">Add Wishlist</button>
<button onclick="removeWishlist()">Remove Wishlist</button>

<div id="wishlistWrapper">
  <table id="wishlist1" style="display:none">
    <tr>
      <td>This is the title of Wishlist 1</td>
    </tr>
  </table>
  <table id="wishlist3" style="display:none">
    <tr>
      <td>This is the title of Wishlist 2</td>
    </tr>
  </table>
  <table id="wishlist2" style="display:none">
    <tr>
      <td>This is the title of Wishlist 3</td>
    </tr>
  </table>
</div>

<script>
function changeTitle(tableName, innerHTML){
  var tableTitle = document.getElementById(tableName).rows[0];
  tableTitle.innerHTML = '<td colspan="2">' + innerHTML + "</td>";
}

function hideTable(tableName){
  var table = document.getElementById(tableName)
  table.style.display = "none";
}

function addWishlist(){

  var tableName = document.getElementById("wishlistname").value

  if (tableName === ""){
    alert("Please put a name in order to add a wishlist.");
    return -1;
  }


  var wishlist1table = document.getElementById("wishlist1")
  var wishlist2table = document.getElementById("wishlist2")
  var wishlist3table = document.getElementById("wishlist3")

  if (wishlist1table.style.display === "none" && wishlist2table.style.display === "none" && wishlist3table.style.display === "none") {
    wishlist1table.style.display = "block";
    changeTitle("wishlist1", tableName)
  } else if (wishlist1table.style.display === "block" && wishlist2table.style.display === "none" && wishlist3table.style.display === "none") {
    wishlist2table.style.display = "block";
    changeTitle("wishlist2", tableName)
  } else if (wishlist1table.style.display === "none" && wishlist2table.style.display === "block" && wishlist3table.style.display === "none") {
    wishlist1table.style.display = "block";
    changeTitle("wishlist1", tableName)
  } else if (wishlist1table.style.display === "none" && wishlist2table.style.display === "none" && wishlist3table.style.display === "block") {
    wishlist1table.style.display = "block";
    changeTitle("wishlist1", tableName)
  } else if (wishlist1table.style.display === "block" && wishlist2table.style.display === "block" && wishlist3table.style.display === "none") {
    wishlist3table.style.display = "block";
    changeTitle("wishlist3", tableName)
  } else if (wishlist1table.style.display === "block" && wishlist2table.style.display === "none" && wishlist3table.style.display === "block") {
    wishlist2table.style.display = "block";
    changeTitle("wishlist2", tableName)
  } else if (wishlist1table.style.display === "none" && wishlist2table.style.display === "block" && wishlist3table.style.display === "block") {
    wishlist1table.style.display = "block";
    changeTitle("wishlist1", tableName)
  } else if (wishlist1table.style.display === "block" && wishlist2table.style.display === "block" && wishlist3table.style.display === "block") {
    alert("You can only have up to 3 wishlists! Feel free to delete any existing wishlist in order to create more.");
  }

}

function clearTable(wishlistName){
  //Clears all content (except the header) of a table
  // wishlistName (String) : name of table you would like to clear the content of.

  document.getElementById(wishlistName).rows[0].cells[0].innerHTML = "";

  var wishlistTableRows = document.getElementById(wishlistName).tBodies[0].rows.length;

  for ( i = wishlistTableRows -1; i >= 1; i--){ // i >= 1 as to not delete the the title of the cell which acts like a innerHTML placeholder.
    var wishlistTableRows = document.getElementById(wishlistName).tBodies[0].rows.length;
    document.getElementById(wishlistName).deleteRow(i);
  }
}

  function removeWishlist(){
    //Removes wishlist

    var tableName = document.getElementById("wishlistname").value.toUpperCase();

    var wishlist1Table = document.getElementById("wishlist1");
    var wishlist2Table = document.getElementById("wishlist2");
    var wishlist3Table = document.getElementById("wishlist3");

    var wishlist1TableTitle = document.getElementById("wishlist1").rows[0].cells[0].innerHTML.toUpperCase();
    var wishlist2TableTitle = document.getElementById("wishlist2").rows[0].cells[0].innerHTML.toUpperCase();
    var wishlist3TableTitle = document.getElementById("wishlist3").rows[0].cells[0].innerHTML.toUpperCase();

    if (tableName === wishlist1TableTitle){
      wishlist1Table.style.display = "none";
      clearTable("wishlist1")
    } else if (tableName === wishlist2TableTitle){
      wishlist2Table.style.display = "none";
      clearTable("wishlist2")
    } else if (tableName === wishlist3TableTitle){
      wishlist3Table.style.display = "none";
      clearTable("wishlist3")
    } else {
      alert("There are no tables with that name!");
    }
  }

  function addToShoppingCart(product, table){
    // sends product to shopping cart via query then removes product from wishlist.

    var deletion = true;

    if (table === "wishlist1"){

      var wishlist1Table = document.getElementById(table);
      var table = wishlist1Table.rows;

      for (i = wishlist1Table.rows.length - 1; i >= 1; i--){

        var titleCell = table[i].cells[0];

        if (product === titleCell.innerHTML && deletion === true){
          var deletion = false;
          console.log(product + " has been removed from " + " wishlist1 and added to Shopping Cart"); //replace with actual query
          wishlist1Table.deleteRow(i);
        }

      } //end of for statement

    } else if (table === "wishlist2"){
      var wishlist2Table = document.getElementById(table);
      var table = wishlist2Table.rows;

      for (i = 1; i <= wishlist2Table.rows.length - 1; i++){

        var titleCell = table[i].cells[0];

        if (product === titleCell.innerHTML && deletion === true){
          var deletion = false;
          console.log(product + " has been removed from " + " wishlist2 and added to Shopping Cart"); //replace with actual query
          wishlist2Table.deleteRow(i);
        } //end of if statement
      }  //end of for statement
    } else if (table === "wishlist3"){
      var wishlist3Table = document.getElementById(table);
      var table = wishlist3Table.rows;

      for (i = 1; i <= wishlist3Table.rows.length - 1; i++){

        var titleCell = table[i].cells[0];

        if (product === titleCell.innerHTML && deletion === true){
          var deletion = false;
          console.log(product + " has been removed from " + " wishlist3 and added to Shopping Cart"); //replace with actual query
          wishlist3Table.deleteRow(i);
          }
        }
      }
  } //end of addToShoppingCart()

  function addToWishlist(){

    var wishlist1Table = document.getElementById("wishlist1");
    var wishlist2Table = document.getElementById("wishlist2");
    var wishlist3Table = document.getElementById("wishlist3");

    //Keeps track of what books should be added to which wishlist
    wishlist1items = [];
    wishlist2items = [];
    wishlist3items = [];

    var table = document.getElementById("resultstable");

    for(i = 1; i <= matches.length; i++){

        var statusCheck1 = table.rows[i].cells[1].children[0].checked;
        var statusCheck2 = table.rows[i].cells[2].children[0].checked;
        var statusCheck3 = table.rows[i].cells[3].children[0].checked;

        if (statusCheck1 === true){
          wishlist1items.push(matches[i - 1]);
        }
        if (statusCheck2 === true){
          wishlist2items.push(matches[i - 1]);
        }
        if (statusCheck3 === true){
          wishlist3items.push(matches[i - 1]);
        }
      }

      if(wishlist1items.length > 0 && wishlist1Table.style.display === "block"){
        for (i = 0; i <= wishlist1items.length - 1; i++){
          var row = wishlist1Table.insertRow(1);

          var cell1 = row.insertCell(0);
          cell1.innerHTML = wishlist1items[i];

          var cell2 = row.insertCell(1);
          cell2.innerHTML = '<button type="button" id="' + cell1.innerHTML + 'addToCartButton" onclick="addToShoppingCart(\'' + cell1.innerHTML + '\', ' + "'wishlist1'" + ')">Add To Shopping Cart</button>';
        }
      } else if (wishlist1items.length > 0 && wishlist1Table.style.display === "none"){
        alert("Wishlist 1 does not exist, please create it below.");
      }


      if(wishlist2items.length > 0 && wishlist2Table.style.display === "block"){
        for (i = 0; i <= wishlist2items.length - 1; i++){
          var row = wishlist2Table.insertRow(1);

          var cell1 = row.insertCell(0);
          cell1.innerHTML = wishlist2items[i];

          var cell2 = row.insertCell(1);
          cell2.innerHTML = '<button type="button" id="' + cell1.innerHTML + 'addToCartButton" onclick="addToShoppingCart(\'' + cell1.innerHTML + '\', ' + "'wishlist2'" + ')">Add To Shopping Cart</button>';
        }
      } else if (wishlist2items.length > 0 && wishlist2Table.style.display === "none"){
        alert("Wishlist 2 does not exist, please create it below.");
      }

      if(wishlist3items.length > 0 && wishlist3Table.style.display === "block"){
        for (i = 0; i <= wishlist3items.length - 1; i++){
          var row = wishlist3Table.insertRow(1);

          var cell1 = row.insertCell(0);
          cell1.innerHTML = wishlist3items[i];

          var cell2 = row.insertCell(1);
          cell2.innerHTML = '<button type="button" id="' + cell1.innerHTML + 'addToCartButton" onclick="addToShoppingCart(\'' + cell1.innerHTML + '\', ' + "'wishlist3'" + ')">Add To Shopping Cart</button>';
        }
      } else if (wishlist3items.length > 0 && wishlist3Table.style.display === "none"){
        alert("Wishlist 3 does not exist, please create it below.");
      }


}



</script>
</div>
</body>
