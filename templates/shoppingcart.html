{% extends "nav.html" %}
{% load static %}
{% load mathfilters %}
{% block page_title %}
    <title>GeekText - Cart</title>
{% endblock %}

{% block content %}
<style media="screen">
hr {
  border: 0;
  clear:both;
  display:block;
  width: 100%;
  background-color: #A9A9A9;
  height: 1px;
}
.shopping-cart{
  display: flex;
  flex-direction: column;
}
.book {
  padding: 20px 30px;
  display: flex;
  border-bottom: 1px solid lightgray;
}
.book-image {
  width: 15%;
  height: 100px;
  align: center;
  margin-right: 50px;
}
.book-information {
  width: 40%;
}
.book-information span {
  display: block;
  font-size: 14px;
  color: #43484D;
  font-weight: 400;
}
.book-quantity {
  width: 10%;
  text-align: center;
  margin-right: 60px;
}
.book-quantity input {
  text-align: center;
  width: 75px;
  color: #43484D;
}
.buttons {
  width: 15%;
}
button {
  background-color: forestgreen;
  text-align: center;
  color: white;
  width: 120px;
  height: 40px;
  border-radius: 10px;
}
button:hover {
  background-color: green;
}
button:focus,
input:focus {
  outline:0;
}
img {
  height: 100px;
}
.book-price {
  width: 10%;
  text-align: center;
}
.book-quantity-price {
  width: 10%;
  text-align: center;
}
.save-container{
  border-style: groove;
  border-radius: 10px;
  width: 65%;
  float: left;
  padding: 20px;
}
.labels {
  padding: 5px 30px;
  text-align: center;
  display: flex;
  height: 40px;
}
.totals {
  border-style: groove;
  border-radius: 10px;
  width: 30%;
  float: right;
  padding: 50px;
}
.totals-book {
  width: 250px;
}
.book .book-price:before, .book .book-quantity-price:before,
.totals .subtotal:before, .totals .tax:before,
.totals .shipping:before, .totals .grandtotal:before{
  content: '$  ';
}
</style>

<div class="shopping-cart">
  <!--Title-->
  <h2>Shopping Cart</h2>
  <!--If there are any books in the user database-->
  {% if True %}
    <div class="labels">
      <div class="book-image"></div>
      <div class="book-information"></div>
      <div class="book-price"><b>Price</b></div>
      <div class="book-quantity"><b>Quantity</b></div>
      <div class="buttons"></div>
      <div class="book-quantity-price"><b>Total</b></div>
    </div><hr>
      <!--For each book in user database-->
    {% for book in books %}
      {% with 'Books/img/'|add:book.title|add:'.jpg' as img_ref %}
      <!--Shopping list test-->
      <div class="book" id="{{ book.id }}">
        <!--Book Image-->
        <div class="book-image" id="book-image">
          <img src="{% static img_ref %}" alt="">
        </div>
        <!--Book Title and Author-->
        <div class="book-information" id="book-information">
          <h5><a style="color: green" href="{% url 'browse' %}" id="book-title">{{ book.title|truncatechars:26 }}</a></h5>
          <h6 id="book-author">{{ book.author }}</h6>
          <p id="book-description">{{ book.description }}</p>
        </div>
        <!--Book Price-->
        <div class="book-price" id="book-price">
          {{ book.price }}
        </div>
        <!--Book Quantity-->
        <div class="book-quantity" id="book-quantity">
          <input type="number" value="1" min="1" id="quantity">
        </div>
        <!--Buttons to save for later or remove-->
        <div class="buttons">
          <button id="save-for-later" class={{book.id}}">Save for later</button>
          <button id="remove-book" class="{{book.id}}">Remove</button>
        </div>
        <!--Book Price * Quantity-->
        <div class="book-quantity-price" id="book-quantity-price">
          {% with 2 as quantity %}
          {{book.price|mul:quantity}}
          {% endwith %}
        </div>
      </div>
      {% endwith %}
    {% endfor %}<br>
    <span>
      <div class="save-container">
        <h3>Save for Later</h3>
        <p>You saved these items to purchase at a later date.</p>
        <hr>
        {% for book in books %}
        {% with 'Books/img/'|add:book.title|add:'.jpg' as img_ref %}
          <img src="{% static img_ref %}" style="padding:5px">
        {% endwith %}
        {% endfor %}
      </div>
      <div class="totals">
        <span>
            <p class="totals-book">Subtotal</p>
            <p class="subtotal">{{book.price}}</p>
            <p class="totals-book">Tax (6%)</p>
            <p class="tax">{{subtotal|mul:.06}}</p>
            <p class="totals-book">Shipping Rate</p>
            <p class="shipping">5.99</p>
            <p class="totals-book">TOTAL</p>
            <p class="grandtotal">90.57</p>
        </span>
        <button class="checkout" onclick="window.location.href = {% url 'checkout' %};">Check Out</button>
      </div>
    </span>
  </div>
    <!--If user database is empty-->
  {% else %}
    <p>Your cart is currently empty. Browse <a style="color: green" href="{% url 'browse' %}"><u>here</u></a> to fill your cart with books.</p>
  {% endif %}
  <script>
    $(document).ready(function(){
      console.log("ready");
    });
    $("#remove-book.1").click(function(){
      console.log("Item 1 removed");
      $("#1.book").remove();
    });
    $("#remove-book.2").click(function(){
      console.log("Item 2 removed");
      $("#2.book").remove();
    });
    $("#remove-book.3").click(function(){
      console.log("Item 3 removed");
      $("#3.book").remove();
    });
    $("#remove-book.4").click(function(){
      console.log("Item 4 removed");
      $("#4.book").remove();
    });
    $("#remove-book.5").click(function(){
      console.log("Item 5 removed");
      $("#5.book").remove();
    });
    $("#save-for-later.1").click(function(){
      console.log("Item 1 hidden and saved for later");
      $("#1.book").hide();
    });
    $("#save-for-later.2").click(function(){
      console.log("Item 2 hidden and saved for later");
      $("#2.book").hide();
    });
    $("#save-for-later.3").click(function(){
      console.log("Item 3 hidden and saved for later");
      $("#3.book").hide();
    });
    $("#save-for-later.4").click(function(){
      console.log("Item 4 hidden and saved for later");
      $("#4.book").hide();
    });
    $("#save-for-later.5").click(function(){
      console.log("Item 5 hidden and saved for later");
      $("#5.book").hide();
    });
  </script>
{% endblock %}
